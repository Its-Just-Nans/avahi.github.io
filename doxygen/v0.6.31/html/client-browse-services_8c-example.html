<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>avahi: client-browse-services.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">avahi
   &#160;<span id="projectnumber">0.6.31</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('client-browse-services_8c-example.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">client-browse-services.c</div>  </div>
</div><!--header-->
<div class="contents">
<p>Example how to browse for DNS-SD services using the client interface to avahi-daemon.</p>
<div class="fragment"><div class="line"><span class="comment">/***</span></div>
<div class="line"><span class="comment">  This file is part of avahi.</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">  avahi is free software; you can redistribute it and/or modify it</span></div>
<div class="line"><span class="comment">  under the terms of the GNU Lesser General Public License as</span></div>
<div class="line"><span class="comment">  published by the Free Software Foundation; either version 2.1 of the</span></div>
<div class="line"><span class="comment">  License, or (at your option) any later version.</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">  avahi is distributed in the hope that it will be useful, but WITHOUT</span></div>
<div class="line"><span class="comment">  ANY WARRANTY; without even the implied warranty of MERCHANTABILITY</span></div>
<div class="line"><span class="comment">  or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General</span></div>
<div class="line"><span class="comment">  Public License for more details.</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">  You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><span class="comment">  License along with avahi; if not, write to the Free Software</span></div>
<div class="line"><span class="comment">  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307</span></div>
<div class="line"><span class="comment">  USA.</span></div>
<div class="line"><span class="comment">***/</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#ifdef HAVE_CONFIG_H</span></div>
<div class="line"><span class="preprocessor">#include &lt;config.h&gt;</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;assert.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;time.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="client_8h.html">avahi-client/client.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lookup_8h.html">avahi-client/lookup.h</a>&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="simple-watch_8h.html">avahi-common/simple-watch.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="malloc_8h.html">avahi-common/malloc.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="error_8h.html">avahi-common/error.h</a>&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <a class="code" href="simple-watch_8h.html#a0e40ccdfdc9d60e7baf0c312347f79b2">AvahiSimplePoll</a> *simple_poll = NULL;</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> resolve_callback(</div>
<div class="line">    <a class="code" href="lookup_8h.html#a95be4e88f06410270e1695304e26f54d">AvahiServiceResolver</a> *r,</div>
<div class="line">    AVAHI_GCC_UNUSED <a class="code" href="address_8h.html#a2fda397a8f430cb537e37bbca0afb535">AvahiIfIndex</a> interface,</div>
<div class="line">    AVAHI_GCC_UNUSED <a class="code" href="address_8h.html#a5342ada86ff1566a7fc6e855b3d46c3d">AvahiProtocol</a> protocol,</div>
<div class="line">    <a class="code" href="defs_8h.html#ae524657615ba2ec3b17613098a3394cf">AvahiResolverEvent</a> event,</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *name,</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *type,</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *domain,</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *host_name,</div>
<div class="line">    <span class="keyword">const</span> <a name="_a0"></a><a class="code" href="struct_avahi_address.html">AvahiAddress</a> *address,</div>
<div class="line">    uint16_t port,</div>
<div class="line">    <a name="_a1"></a><a class="code" href="struct_avahi_string_list.html">AvahiStringList</a> *txt,</div>
<div class="line">    <a class="code" href="defs_8h.html#a0d69521c9408634d97c41435f4ecbfd7">AvahiLookupResultFlags</a> flags,</div>
<div class="line">    AVAHI_GCC_UNUSED <span class="keywordtype">void</span>* userdata) {</div>
<div class="line"></div>
<div class="line">    assert(r);</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Called whenever a service has been resolved successfully or timed out */</span></div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">switch</span> (event) {</div>
<div class="line">        <span class="keywordflow">case</span> <a name="a2"></a><a class="code" href="defs_8h.html#ae524657615ba2ec3b17613098a3394cfa407f93fe14b008cc1a7ff00eef454528">AVAHI_RESOLVER_FAILURE</a>:</div>
<div class="line">            fprintf(stderr, <span class="stringliteral">&quot;(Resolver) Failed to resolve service &#39;%s&#39; of type &#39;%s&#39; in domain &#39;%s&#39;: %s\n&quot;</span>, name, type, domain, <a name="a3"></a><a class="code" href="error_8h.html#acb801f36563fde5d25b0b2b2cae8dfe0">avahi_strerror</a>(<a name="a4"></a><a class="code" href="client_8h.html#a763d48f8147ab488456705970ea20e44">avahi_client_errno</a>(<a name="a5"></a><a class="code" href="lookup_8h.html#a4fe474c16833eef22b1cebe8388f7dff">avahi_service_resolver_get_client</a>(r))));</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">case</span> <a name="a6"></a><a class="code" href="defs_8h.html#ae524657615ba2ec3b17613098a3394cfaa27397e0a76171dd9afe7cf2fe9b1f22">AVAHI_RESOLVER_FOUND</a>: {</div>
<div class="line">            <span class="keywordtype">char</span> a[<a name="a7"></a><a class="code" href="address_8h.html#a30245a7d8dabf1e655e0282e5d427dac">AVAHI_ADDRESS_STR_MAX</a>], *t;</div>
<div class="line"></div>
<div class="line">            fprintf(stderr, <span class="stringliteral">&quot;Service &#39;%s&#39; of type &#39;%s&#39; in domain &#39;%s&#39;:\n&quot;</span>, name, type, domain);</div>
<div class="line"></div>
<div class="line">            <a name="a8"></a><a class="code" href="address_8h.html#adb9715709be6f8ef6a09899d17664185">avahi_address_snprint</a>(a, <span class="keyword">sizeof</span>(a), address);</div>
<div class="line">            t = <a name="a9"></a><a class="code" href="strlst_8h.html#a5c4b9ab709f22f7741c165ca3756a78b">avahi_string_list_to_string</a>(txt);</div>
<div class="line">            fprintf(stderr,</div>
<div class="line">                    <span class="stringliteral">&quot;\t%s:%u (%s)\n&quot;</span></div>
<div class="line">                    <span class="stringliteral">&quot;\tTXT=%s\n&quot;</span></div>
<div class="line">                    <span class="stringliteral">&quot;\tcookie is %u\n&quot;</span></div>
<div class="line">                    <span class="stringliteral">&quot;\tis_local: %i\n&quot;</span></div>
<div class="line">                    <span class="stringliteral">&quot;\tour_own: %i\n&quot;</span></div>
<div class="line">                    <span class="stringliteral">&quot;\twide_area: %i\n&quot;</span></div>
<div class="line">                    <span class="stringliteral">&quot;\tmulticast: %i\n&quot;</span></div>
<div class="line">                    <span class="stringliteral">&quot;\tcached: %i\n&quot;</span>,</div>
<div class="line">                    host_name, port, a,</div>
<div class="line">                    t,</div>
<div class="line">                    avahi_string_list_get_service_cookie(txt),</div>
<div class="line">                    !!(flags &amp; <a name="a10"></a><a class="code" href="defs_8h.html#a0d69521c9408634d97c41435f4ecbfd7abbf16c5d7a3790451bd1a9d835702d5d">AVAHI_LOOKUP_RESULT_LOCAL</a>),</div>
<div class="line">                    !!(flags &amp; <a name="a11"></a><a class="code" href="defs_8h.html#a0d69521c9408634d97c41435f4ecbfd7a25d1fbc291fd65bcc1d12a5b51ebd6c9">AVAHI_LOOKUP_RESULT_OUR_OWN</a>),</div>
<div class="line">                    !!(flags &amp; <a name="a12"></a><a class="code" href="defs_8h.html#a0d69521c9408634d97c41435f4ecbfd7aa1617f6736538c40bb14b3d54336e66c">AVAHI_LOOKUP_RESULT_WIDE_AREA</a>),</div>
<div class="line">                    !!(flags &amp; <a name="a13"></a><a class="code" href="defs_8h.html#a0d69521c9408634d97c41435f4ecbfd7ac34ea399ed04f8650fad8a5e098cfa29">AVAHI_LOOKUP_RESULT_MULTICAST</a>),</div>
<div class="line">                    !!(flags &amp; <a name="a14"></a><a class="code" href="defs_8h.html#a0d69521c9408634d97c41435f4ecbfd7a901cb53511bc147c0b5373a93b623b54">AVAHI_LOOKUP_RESULT_CACHED</a>));</div>
<div class="line"></div>
<div class="line">            <a name="a15"></a><a class="code" href="malloc_8h.html#af0d93804e70823f30f7680d2f8845ed4">avahi_free</a>(t);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <a name="a16"></a><a class="code" href="lookup_8h.html#a0fc2e738e567f56ad57c0ad023ebbf05">avahi_service_resolver_free</a>(r);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> browse_callback(</div>
<div class="line">    <a class="code" href="lookup_8h.html#ade1392a93ff4d0407c1735374bc0ff7b">AvahiServiceBrowser</a> *b,</div>
<div class="line">    <a class="code" href="address_8h.html#a2fda397a8f430cb537e37bbca0afb535">AvahiIfIndex</a> interface,</div>
<div class="line">    <a class="code" href="address_8h.html#a5342ada86ff1566a7fc6e855b3d46c3d">AvahiProtocol</a> protocol,</div>
<div class="line">    <a class="code" href="defs_8h.html#af7ff3b95259b3441a282b87d82eebd87">AvahiBrowserEvent</a> event,</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *name,</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *type,</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *domain,</div>
<div class="line">    AVAHI_GCC_UNUSED <a class="code" href="defs_8h.html#a0d69521c9408634d97c41435f4ecbfd7">AvahiLookupResultFlags</a> flags,</div>
<div class="line">    <span class="keywordtype">void</span>* userdata) {</div>
<div class="line"></div>
<div class="line">    <a class="code" href="client_8h.html#a3d65e9ea7182c44fa8df04a72f1a56bb">AvahiClient</a> *c = userdata;</div>
<div class="line">    assert(b);</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Called whenever a new services becomes available on the LAN or is removed from the LAN */</span></div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">switch</span> (event) {</div>
<div class="line">        <span class="keywordflow">case</span> <a name="a17"></a><a class="code" href="defs_8h.html#af7ff3b95259b3441a282b87d82eebd87a84a4230c3a9f25afde40f65d21909675">AVAHI_BROWSER_FAILURE</a>:</div>
<div class="line"></div>
<div class="line">            fprintf(stderr, <span class="stringliteral">&quot;(Browser) %s\n&quot;</span>, <a class="code" href="error_8h.html#acb801f36563fde5d25b0b2b2cae8dfe0">avahi_strerror</a>(<a class="code" href="client_8h.html#a763d48f8147ab488456705970ea20e44">avahi_client_errno</a>(<a name="a18"></a><a class="code" href="lookup_8h.html#afb7165e6c3a38b6da70eddd510211784">avahi_service_browser_get_client</a>(b))));</div>
<div class="line">            <a name="a19"></a><a class="code" href="simple-watch_8h.html#ac2771664e4e6c7e75e5b5a270e5e0490">avahi_simple_poll_quit</a>(simple_poll);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">case</span> <a name="a20"></a><a class="code" href="defs_8h.html#af7ff3b95259b3441a282b87d82eebd87adb84c76ca1876beeb4f1ac718633667c">AVAHI_BROWSER_NEW</a>:</div>
<div class="line">            fprintf(stderr, <span class="stringliteral">&quot;(Browser) NEW: service &#39;%s&#39; of type &#39;%s&#39; in domain &#39;%s&#39;\n&quot;</span>, name, type, domain);</div>
<div class="line"></div>
<div class="line">            <span class="comment">/* We ignore the returned resolver object. In the callback</span></div>
<div class="line"><span class="comment">               function we free it. If the server is terminated before</span></div>
<div class="line"><span class="comment">               the callback function is called the server will free</span></div>
<div class="line"><span class="comment">               the resolver for us. */</span></div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">if</span> (!(<a name="a21"></a><a class="code" href="lookup_8h.html#a904611a4134ceb5919f6bb637df84124">avahi_service_resolver_new</a>(c, interface, protocol, name, type, domain, <a name="a22"></a><a class="code" href="address_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba6c1837afa356a983f188e35911dc0d84">AVAHI_PROTO_UNSPEC</a>, 0, resolve_callback, c)))</div>
<div class="line">                fprintf(stderr, <span class="stringliteral">&quot;Failed to resolve service &#39;%s&#39;: %s\n&quot;</span>, name, <a class="code" href="error_8h.html#acb801f36563fde5d25b0b2b2cae8dfe0">avahi_strerror</a>(<a class="code" href="client_8h.html#a763d48f8147ab488456705970ea20e44">avahi_client_errno</a>(c)));</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">case</span> <a name="a23"></a><a class="code" href="defs_8h.html#af7ff3b95259b3441a282b87d82eebd87ab3adb8824483c87b557a885ee280814c">AVAHI_BROWSER_REMOVE</a>:</div>
<div class="line">            fprintf(stderr, <span class="stringliteral">&quot;(Browser) REMOVE: service &#39;%s&#39; of type &#39;%s&#39; in domain &#39;%s&#39;\n&quot;</span>, name, type, domain);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">case</span> <a name="a24"></a><a class="code" href="defs_8h.html#af7ff3b95259b3441a282b87d82eebd87a430e1134047305e7b892e784cf72f815">AVAHI_BROWSER_ALL_FOR_NOW</a>:</div>
<div class="line">        <span class="keywordflow">case</span> <a name="a25"></a><a class="code" href="defs_8h.html#af7ff3b95259b3441a282b87d82eebd87a796b2e4c7e82580fb93fd29151aa5752">AVAHI_BROWSER_CACHE_EXHAUSTED</a>:</div>
<div class="line">            fprintf(stderr, <span class="stringliteral">&quot;(Browser) %s\n&quot;</span>, event == <a class="code" href="defs_8h.html#af7ff3b95259b3441a282b87d82eebd87a796b2e4c7e82580fb93fd29151aa5752">AVAHI_BROWSER_CACHE_EXHAUSTED</a> ? <span class="stringliteral">&quot;CACHE_EXHAUSTED&quot;</span> : <span class="stringliteral">&quot;ALL_FOR_NOW&quot;</span>);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> client_callback(<a class="code" href="client_8h.html#a3d65e9ea7182c44fa8df04a72f1a56bb">AvahiClient</a> *c, <a class="code" href="client_8h.html#aaf9074b91ffd35b940e09448a9cd45e9">AvahiClientState</a> state, AVAHI_GCC_UNUSED <span class="keywordtype">void</span> * userdata) {</div>
<div class="line">    assert(c);</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Called whenever the client or server state changes */</span></div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (state == <a name="a26"></a><a class="code" href="client_8h.html#aaf9074b91ffd35b940e09448a9cd45e9a04583aa28fec0f0987fd2d3a1814db4b">AVAHI_CLIENT_FAILURE</a>) {</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;Server connection failure: %s\n&quot;</span>, <a class="code" href="error_8h.html#acb801f36563fde5d25b0b2b2cae8dfe0">avahi_strerror</a>(<a class="code" href="client_8h.html#a763d48f8147ab488456705970ea20e44">avahi_client_errno</a>(c)));</div>
<div class="line">        <a class="code" href="simple-watch_8h.html#ac2771664e4e6c7e75e5b5a270e5e0490">avahi_simple_poll_quit</a>(simple_poll);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main(AVAHI_GCC_UNUSED <span class="keywordtype">int</span> argc, AVAHI_GCC_UNUSED <span class="keywordtype">char</span>*argv[]) {</div>
<div class="line">    <a class="code" href="client_8h.html#a3d65e9ea7182c44fa8df04a72f1a56bb">AvahiClient</a> *client = NULL;</div>
<div class="line">    <a class="code" href="lookup_8h.html#ade1392a93ff4d0407c1735374bc0ff7b">AvahiServiceBrowser</a> *sb = NULL;</div>
<div class="line">    <span class="keywordtype">int</span> error;</div>
<div class="line">    <span class="keywordtype">int</span> ret = 1;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Allocate main loop object */</span></div>
<div class="line">    <span class="keywordflow">if</span> (!(simple_poll = <a name="a27"></a><a class="code" href="simple-watch_8h.html#a4548a645c8ae50edd0617c8d9a15a9bd">avahi_simple_poll_new</a>())) {</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;Failed to create simple poll object.\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">goto</span> fail;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Allocate a new client */</span></div>
<div class="line">    client = <a name="a28"></a><a class="code" href="client_8h.html#a07b2a33a3e7cbb18a0eb9d00eade6ae6">avahi_client_new</a>(<a name="a29"></a><a class="code" href="simple-watch_8h.html#a8e7a53b4116c2379d04f8298398e59e8">avahi_simple_poll_get</a>(simple_poll), 0, client_callback, NULL, &amp;error);</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Check wether creating the client object succeeded */</span></div>
<div class="line">    <span class="keywordflow">if</span> (!client) {</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;Failed to create client: %s\n&quot;</span>, <a class="code" href="error_8h.html#acb801f36563fde5d25b0b2b2cae8dfe0">avahi_strerror</a>(error));</div>
<div class="line">        <span class="keywordflow">goto</span> fail;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Create the service browser */</span></div>
<div class="line">    <span class="keywordflow">if</span> (!(sb = <a name="a30"></a><a class="code" href="lookup_8h.html#a52d55a5156a7943012d03e6700880d2b">avahi_service_browser_new</a>(client, <a name="a31"></a><a class="code" href="address_8h.html#adf764cbdea00d65edcd07bb9953ad2b7a9cefc02b2cc49f5a4c8effb3f610cca6">AVAHI_IF_UNSPEC</a>, <a class="code" href="address_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba6c1837afa356a983f188e35911dc0d84">AVAHI_PROTO_UNSPEC</a>, <span class="stringliteral">&quot;_http._tcp&quot;</span>, NULL, 0, browse_callback, client))) {</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;Failed to create service browser: %s\n&quot;</span>, <a class="code" href="error_8h.html#acb801f36563fde5d25b0b2b2cae8dfe0">avahi_strerror</a>(<a class="code" href="client_8h.html#a763d48f8147ab488456705970ea20e44">avahi_client_errno</a>(client)));</div>
<div class="line">        <span class="keywordflow">goto</span> fail;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Run the main loop */</span></div>
<div class="line">    <a name="a32"></a><a class="code" href="simple-watch_8h.html#a14b4cb29832e8c3de609d4c4e5611985">avahi_simple_poll_loop</a>(simple_poll);</div>
<div class="line"></div>
<div class="line">    ret = 0;</div>
<div class="line"></div>
<div class="line">fail:</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Cleanup things */</span></div>
<div class="line">    <span class="keywordflow">if</span> (sb)</div>
<div class="line">        <a name="a33"></a><a class="code" href="lookup_8h.html#a2221ea447d014e3d962470aa8fe96ae1">avahi_service_browser_free</a>(sb);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (client)</div>
<div class="line">        <a name="a34"></a><a class="code" href="client_8h.html#aceb92c59523def4de9f745f4149cb392">avahi_client_free</a>(client);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (simple_poll)</div>
<div class="line">        <a name="a35"></a><a class="code" href="simple-watch_8h.html#a2d23c812725d77cf4c6478d249bb434e">avahi_simple_poll_free</a>(simple_poll);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> ret;</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Mar 23 2015 10:02:04 for avahi by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.9.1 </li>
  </ul>
</div>
</body>
</html>
